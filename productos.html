<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Mis Productos</title>
  
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
      <link rel="stylesheet" href="assets/css/main.css">
      <link rel="stylesheet" href="assets/css/home.css">
      <link rel="stylesheet" href="assets/css/productos.css">
      <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  
      <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"
      />
  
      <!-- scroll animations -->
  
  
      <!-- Swiper CSS -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  
  
  
      <!-- ADD THIS AOS CSS -->
      <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- <style>
      .grid {
        display: grid;
        gap: 1rem;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      }
      .card {
        border: 1px solid #ccc;
        border-radius: 12px;
        padding: 1rem;
        background: #fff;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .card img {
        max-width: 100%;
        border-radius: 8px;
      }
    </style> -->
  
  </head>
<body>
  <div class="mainContainerProductos">
    <!-- nav -->
    <nav class="nav mainText">
      <div class="nav-item-1">
          <a href="index.html">
              <img src="/assets/img/common/arias_logo.png" alt="nav_logo" width="64">
              <span style="color: white;">Arias Joyeria</span>
          </a>
      </div>

      <div class="navLinks">
          <div class="item2">
              <a href="">
                  <span>Inicio</span>
              </a>
          </div>
          <div class="item3">
              <a href="">
                  <span>Acerca de nosotros</span>
              </a>
          </div>
          <div class="item4">
              <a href="https://www.instagram.com/arias_joyeria_/?igsh=MXR0OTdubWw2aDY2bA%3D%3D#" target="_blank">
                  <span>OBTENER COTIZACION</span>
              </a>
          </div>
      </div>
  </nav>
    
    
    <!-- prodcutos -->
    <div id="filtros" class="filterNav"></div>
    <div id="productos-container" class="products"></div>
  </div>
    










    <!-- Cargar marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/gray-matter@4.0.3/dist/gray-matter.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


    <script>
        function parseFrontmatter(content) {
          const match = /^---\s*([\s\S]*?)\s*---\s*([\s\S]*)$/m.exec(content);
          if (!match) return { data: {}, content };
      
          const yaml = match[1];
          const body = match[2];
      
          const data = {};
          yaml.split('\n').forEach(line => {
            const [key, ...rest] = line.split(':');
            data[key.trim()] = rest.join(':').trim();
          });
      
          return { data, content: body };
        }
      
        let productos = [];
      
        async function cargarProductos() {
          const res = await fetch("assets/data/productos/productos.json");
          const archivos = await res.json();
          const resultados = [];
      
          for (const archivo of archivos) {
            try {
              const res = await fetch(archivo);
              if (!res.ok) {
                console.warn(`❌ Archivo no encontrado: ${archivo}`);
                continue;
              }
      
              const texto = await res.text();
              const parsed = parseFrontmatter(texto); // or use `matter(texto)`
              parsed.ruta = archivo; // optional: for debugging
              resultados.push(parsed);
            } catch (err) {
              console.error("Error cargando producto:", archivo, err);
            }
          }
      
          productos = resultados;
          generarBotonesDeFiltro();
          renderizarProductos(productos);
        }
      
        function generarBotonesDeFiltro() {
          const categorias = [...new Set(productos.map(p => p.data.categoria))];
          const contenedor = document.getElementById("filtros");
          contenedor.innerHTML = "";
      
          const crearBoton = (texto, categoria) => {
            const btn = document.createElement("button");
            btn.className = 'filterBtn';
            btn.textContent = texto;
            btn.style.marginRight = "10px";
            btn.onclick = () => {
              const filtrados = categoria === "all"
                ? productos
                : productos.filter(p => p.data.categoria === categoria);
              renderizarProductos(filtrados);
            };
            contenedor.appendChild(btn);
          };
      
          crearBoton("Todos", "all");
          categorias.forEach(cat => crearBoton(cat, cat));
        }
      
        function renderizarProductos(lista) {
          const contenedor = document.getElementById("productos-container");
          contenedor.innerHTML = "";
      
          lista.forEach(parsed => {
            const htmlContenido = marked.parse(parsed.content);
            const card = document.createElement("div");
            card.classList.add("card");
      
            card.innerHTML = `
              <div class="cardItem">
                <div class="image">
                  <img src="${parsed.data.image}" alt="${parsed.data.title}">
                </div>
                <div class="desc">
                  <h2>${parsed.data.title}</h2>
                </div>
                <div class="detalles">
                  <p><em>${parsed.data.details || ""}</em></p>
                  <p><strong>Categoría:</strong> ${parsed.data.categoria || "Sin categoría"}</p>
                </div>
                <div class="detallesBoton">
                  <a class="btnSecondary btnCard" href="producto.html?id=${parsed.data.slug || getSlugFromPath(parsed.ruta)}">Ver más</a>
                </div>
              </div>
            `;
      

            function getSlugFromPath(path) {
              return path.split('/').pop().replace('.md', '');
            }

            contenedor.appendChild(card);
          });
        }
      
        cargarProductos();
      </script>
      
</body>
</html>